<?xml version="1.0" encoding="UTF-8"?>
<sequence name="WorkForceSequence" xmlns="http://ws.apache.org/ns/synapse">
    <log category="INFO">
        <message>Calling WorkForce Service</message>
    </log>
    
    <!-- Initialize retry counter -->
    <variable name="retryCount" type="INTEGER" value="0"/>
    <variable name="maxRetries" type="INTEGER" value="3"/>
    <variable name="workForceSuccess" type="BOOLEAN" value="false"/>
    
    <!-- Retry loop sequence -->
    <sequence key="WorkForceRetrySequence"/>
    
    <!-- Check final result -->
    <filter xpath="${vars.workForceSuccess == false}">
        <then>
            <log category="ERROR">
                <message>WorkForce service failed after ${vars.maxRetries} retries</message>
            </log>
            <throwError type="WORKFORCE_ERROR" errorMessage="WorkForce service failed after maximum retries"/>
        </then>
        <else>
            <log category="INFO">
                <message>WorkForce service completed successfully</message>
            </log>
        </else>
    </filter>
</sequence>